<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>이력서 - 템플릿</title>
  <style>
    body {
      font-family: 'Noto Sans KR', sans-serif;
      margin: 0;
      padding: 60px;
      background: #f6f6f6;
      color: #000;
    }
    .container {
      width: 800px;
      margin: auto;
      background: #fff;
      padding: 40px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h1 {
      text-align: center;
      font-size: 28px;
      margin-bottom: 40px;
    }
    .photo-section {
      display: flex;
      align-items: center;
      margin-bottom: 30px;
    }
    .photo-section img {
      width: 120px;
      height: 150px;
      object-fit: cover;
      border: 1px solid #ccc;
      margin-right: 20px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 30px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: left;
      font-size: 14px;
      height: 38px;
    }
    th {
      background-color: #f0f0f0;
    }
    .section-title {
      font-size: 18px;
      font-weight: bold;
      margin: 30px 0 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>이력서</h1>

    <div class="photo-section">
      <img src="https://via.placeholder.com/120x150?text=사진" alt="사진">
      <table>
        <tr><th>이름</th><td>&nbsp;</td></tr>
        <tr><th>이메일</th><td>&nbsp;</td></tr>
        <tr><th>전화번호</th><td>&nbsp;</td></tr>
        <tr><th>홈페이지</th><td>&nbsp;</td></tr>
      </table>
    </div>

    <div class="section-title">교육사항</div>
    <table>
      <tr><th>학교명</th><th>전공</th><th>기간</th></tr>
      <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
      <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
      <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
    </table>

    <div class="section-title">경력사항</div>
    <table>
      <tr><th>회사명</th><th>부서</th><th>직위</th><th>기간</th></tr>
      <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
      <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
    </table>

    <div class="section-title">언어 및 자격증</div>
    <table>
      <tr><th>항목</th><th>내용</th></tr>
      <tr><td>&nbsp;</td><td>&nbsp;</td></tr>
      <tr><td>&nbsp;</td><td>&nbsp;</td></tr>
    </table>

    <div class="section-title">프로젝트</div>
    <table>
      <tr><th>프로젝트명</th><th>내용</th></tr>
      <tr><td>&nbsp;</td><td>&nbsp;</td></tr>
      <tr><td>&nbsp;</td><td>&nbsp;</td></tr>
    </table>

    <div class="section-title">자기소개</div>
    <table>
      <tr><td style="height: 100px">&nbsp;</td></tr>
    </table>
  </div>
<script>
      function sendIframeHeight() {
        // 'container' 요소의 높이를 측정하는 것이 가장 정확합니다.
        // body의 margin과 padding을 0으로 설정했기 때문에 container의 높이가 곧 콘텐츠의 실제 높이가 됩니다.
        const containerElement = document.querySelector('.container');
        let height = 0;
        if (containerElement) {
            height = containerElement.offsetHeight;
        } else {
            // container가 없다면 fallback으로 body 높이를 사용합니다.
            height = Math.max(
                document.body.scrollHeight,
                document.body.offsetHeight,
                document.documentElement.clientHeight,
                document.documentElement.scrollHeight,
                document.documentElement.offsetHeight
            );
        }

        // 부모 윈도우로 메시지 전송
        if (window.parent) {
          window.parent.postMessage({
            type: 'iframeHeight',
            height: height + 'px', // 단위를 붙여서 보냅니다.
            tempNo: new URLSearchParams(window.location.search).get('tempNo') // 템플릿 번호도 함께 보냅니다.
          }, '*'); // 🚨 중요: 실제 배포 시에는 '*' 대신 부모 컴포넌트의 도메인을 명시하세요!
        }
      }

      // 1. DOMContentLoaded: HTML 문서가 완전히 로드되고 파싱되었을 때 (가장 빠름)
      document.addEventListener('DOMContentLoaded', sendIframeHeight);
      // 2. load: 모든 리소스(이미지 등)까지 완전히 로드되었을 때 (더 정확할 수 있음)
      window.addEventListener('load', sendIframeHeight);
      // 3. 리사이즈 시에도 높이 다시 측정하여 부모에 알림 (반응형 대응)
      window.addEventListener('resize', sendIframeHeight);

      // 4. 추가: 이미지 등 동적으로 로드되는 요소가 있다면, 해당 요소의 로드가 완료된 후 다시 높이를 측정합니다.
      // 현재 이력서 템플릿에는 외부 이미지가 있으므로 이 부분이 특히 중요합니다.
      const images = document.querySelectorAll('img');
      if (images.length > 0) {
        let loadedCount = 0;
        images.forEach(img => {
          if (img.complete) { // 이미 로드 완료된 이미지
            loadedCount++;
          } else { // 아직 로드되지 않은 이미지
            img.addEventListener('load', () => {
              loadedCount++;
              if (loadedCount === images.length) {
                sendIframeHeight(); // 모든 이미지가 로드되면 높이 다시 전송
              }
            });
          }
        });
        if (loadedCount === images.length) { // 이미지가 없거나 모두 로드된 경우에도 초기 높이 전송
          sendIframeHeight();
        }
      }
    </script>
</body>
</html>
